
<!DOCTYPE html><html lang="en"><head><title>Reactive Programming in Python -- Keith Yang</title><meta charset="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="shower/material/styles/screen-16x9.css"/><link rel="stylesheet" href="font-awesome/css/font-awesome.min.css"/><link rel="stylesheet" href="pygments.css"/><style>.text-center {
  text-align: center; }

  .name {
    font-family: Trebuchet MS, Lucida Grande, Lucida Sans, Tahoma, sans-serif; }

    .slide, .slide.active {
      font-size: 30px; }
      .slide.loading, .slide.active.loading {
        background: #121212; }
        .slide.fullcode h2, .slide.active.fullcode h2 {
          margin-top: -36px;
          margin-bottom: 40px; }
          .slide.fullcode pre, .slide.active.fullcode pre {
            margin-top: -36px; }
            .slide.fullcode.max.slide.active::after,
            .slide.active.fullcode.max.slide.active::after {
              left: 54px; }
              .slide.fullcode.max h2, .slide.active.fullcode.max h2 {
                margin-top: -60px;
                margin-bottom: 64px; }
                .slide.fullcode.max pre, .slide.active.fullcode.max pre {
                  margin-top: -54px; }
                  .slide.fullcode.max pre .codehilite, .slide.active.fullcode.max pre .codehilite {
                    font-size: 20px; }
      .slide.outlines h3, .slide.active.outlines h3 {
        font-size: 38px; }
        .slide h2, .slide.active h2 {
          color: #d43842; }
          .slide h2.focustitle, .slide.active h2.focustitle {
            color: #FFF;
            text-shadow: 0 0 32px #000, 0 0 16px #000, 0 0 8px #000, 0 0 4px #000; }
            .slide h2.focustitle.red, .slide.active h2.focustitle.red {
              color: #d43842;
              text-shadow: 0 0 32px #fff, 0 0 16px #fff, 0 0 8px #fff, 0 0 4px #fff, 0 0 32px #fff,
                            0 0 16px #fff, 0 0 8px #fff, 0 0 4px #fff, 0 0 64px #fff, 0 0 48px #fff,
                            0 0 32px #fff, 0 0 4px #fff; }
              .slide h2.shout, .slide.active h2.shout {
                color: #FFF; }
                .slide a, .slide.active a {
                  background: none; }
                  .slide .kred, .slide.active .kred {
                    color: #d43842; }
                    .slide .kblue, .slide.active .kblue {
                      color: #498cd6; }
                      .slide .kblack, .slide.active .kblack {
                        color: #121212; }
                        .slide .kwhite, .slide.active .kwhite {
                          color: #f0f0f0; }
                          .slide .pyctw, .slide.active .pyctw {
                            color: #3e6df5; }
                            .slide p, .slide li, .slide.active p, .slide.active li {
                              font-size: 30px; }
                              .slide i.fa, .slide.active i.fa {
                                font-style: normal;
                                text-indent: 0; }
                                .slide .fs-xl, .slide.active .fs-xl {
                                  font-size: 180%; }
                                  .slide .fs-l, .slide.active .fs-l {
                                    font-size: 160%; }
                                    .slide .fs-s, .slide.active .fs-s {
                                      font-size: 80%; }
                                      .slide .fs-s li, .slide.active .fs-s li {
                                        font-size: 80%; }
      .slide .fs-xs, .slide.active .fs-xs {
        font-size: 60%; }
        .slide .fs-xs li, .slide.active .fs-xs li {
          font-size: 60%; }
          .slide .fs-xs ul li, .slide.active .fs-xs ul li {
            font-size: 60%; }
      .slide pre .codehilite, .slide.active pre .codehilite {
        font-size: 28px;
        line-height: 1.2;
        padding: 0.1em 0.3em;
        background: #efefcf; }
        .slide .text-right, .slide.active .text-right {
          text-align: right; }</style></head><body class="shower list"><header class="caption"><h1>Reactive Programming in Python</h1><p class="name">Keith Yang</p></header><section id="game" class="slide loading"><h2>What is Reactive?</h2><img src="pictures/how_reactive.jpg" alt="" width="100%" class="cover"/><style>#game h2 {
  color: #FFF;
  text-shadow: 24px 24px 1px #f36131, -48px -48px 2px #63a1f1, 72px 72px 3px #33f161,
    -96px -96px 4px #f3f161; }</style></section><section class="slide"><h2 class="shout">Game<br/><span>is reactive.</span></h2></section><section class="slide"><h2 class="shout">Presentation?<br/><span class="next">not</span></h2></section><section class="slide"><h2 class="focustitle fs-xl">... if you fall into sleep</h2><img src="pictures/fall_into_sleep.jpg" alt="" width="100%" class="cover"/></section><section id="cover" class="slide"><h2>Reactive Programming<br/>in Python</h2><hr/><h4><a href="https://yang.keitheis.org" class="name">Keith Yang</a></h4><pre><code><a href="mailto:yang@keitheis.org">yang@keitheis.org</a><br/>@keitheis <a href="https://twitter.com/keitheis" class="kblack"><i class="fa fa-twitter"></i></a> <a href="https://bitbucket.org/keitheis" class="kblack"><i class="fa fa-bitbucket"></i></a> <a href="https://github.com/keitheis" class="kblack"><i class="fa fa-github"></i></a></code></pre><pre><code class="text-center pyctw">PyCon Taiwan 2016</code></pre></section><section class="slide"><img src="pictures/mecollage.png" class="cover"/></section><section class="slide"><h2 class="text-center"><i class="fa fa-battery-full"></i> Keith Yang</h2><h3 class="text-center kred">Sofeware Engineering Artisan</h3><ul>
<li>Coding</li>
<li>Agile</li>
<li>Web &amp; Cloud &amp; Virtualization</li>
</ul><p class="text-center fs-s"><a href="http://taipei.python.org.tw/">@Taipeipy</a> & <a href="http://tw.pycon.org/">@PyConTW</a></p></section><section class="outlines slide"><h2>Outlines</h2><h3>I. What & Why <i class="fa fa-info-circle"></i></h3><h3>II. Dive into <i class="fa fa-heart"></i> & play with <i class="fa fa-gamepad"></i></h3><h3>III. Thumbs up <i class="fa fa-thumbs-up"></i></h3><p class="note text-center">Reactive Programming in Python</p></section><section class="slide"><h2 class="shout">I. What is<br/>Reactive Programming?</h2></section><section class="slide loading"><h2 class="focustitle">My hand... tell me!</h2><img src="pictures/holograph.jpg" alt="" width="100%" class="cover"/></section><section class="slide"><h2>Seen on web application</h2><ul>
<li>The feel of <mark>interactive</mark></li>
<li>For example:
<ul>
<li>Hackfoldr, Gitter, Slack, Web IRC, ...</li>
<li>Gmail, Facebook, Twitter, Pinterest, Plurk, ...</li>
<li>Online map, calendars, document, ...</li>
</ul></li>
</ul></section><section class="slide"><h2 class="shout">I mean...<br/>programming?</h2></section><section class="slide"><h2 class="shout">Functional<br/>Python<br/>101 <i class="fa fa-check-square-o"></i></h2></section><section class="slide"><h2>Map</h2><p>Map a iterable, i.e., a list, to a function.</p>
<pre><code><div class="codehilite"><span class="n">In</span> <span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="n">str_map</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span><br/><br/><span class="n">In</span> <span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="nb">list</span><span class="p">(</span><span class="n">str_map</span><span class="p">)</span><br/><span class="n">Out</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="s1">&#39;3&#39;</span><span class="p">]</span><br/></div></code></pre></section><section class="slide"><h2>Lambda</h2><p>Create small <mark>anonymous function</mark> inline.</p>
<pre><code><div class="codehilite"><span class="n">In</span> <span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="n">multiple_7</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">*</span> <span class="mi">7</span><br/><br/><span class="n">In</span> <span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="nb">type</span><span class="p">(</span><span class="n">multiple_7</span><span class="p">)</span><br/><span class="n">Out</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="n">function</span><br/><br/><span class="n">In</span> <span class="p">[</span><span class="mi">3</span><span class="p">]:</span> <span class="n">multiple_7</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><br/><span class="n">Out</span><span class="p">[</span><span class="mi">3</span><span class="p">]:</span> <span class="mi">42</span><br/></div></code></pre><p class="note text-center">Function is first-class object in Python.</p></section><section class="slide"><h2>Map & Lambda</h2>
<pre><code><div class="codehilite"><span class="n">In</span> <span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]))</span><br/><br/><span class="n">Out</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span><br/></div></code></pre></section><section class="slide"><h2>Programming Paradigms</h2><ul><li>Declarative (i.e., Functional programming)<br/><span class="fs-s next">Functional languages: <span class="kblue">Scheme, Clojure, Erlang, Haskell, OCaml</span></span></li><li>Imperative (i.e., Procedural programming)<br/><span class="fs-s next">Procedural programming languages: <span class="kblue">C, Go, Fortran, Pascal, and BASIC</span></span></li></ul></section><section class="slide"><h2>Declarative: Dataflow: Reactive</h2><h3>Category of Reactive Programming Paradigm</h3><h4>Relatives:</h4><ul>
<li>Declarative: Functional</li>
<li>Dataflow: Flow-based programming</li>
</ul></section><section class="slide"><h2 class="shout">(Events) Stream</h2></section><section class="slide"><h2>Stream<span class="next">: Core Spirit of Reactive<span></h2><p>“Everything can be a stream!”</p><p>The mantra of Reactive Programming.</p><p>In brief a sequence of events.</p></section><section class="slide loading"><h2 class="focustitle">Stream</h2><img src="pictures/stream.jpg" alt="" width="100%" class="cover"/></section><section class="slide"><h2>Stream in <mark>for in if</mark></h2>
<pre><code><div class="codehilite"><span class="p">(</span> <span class="n">expression</span> <span class="k">for</span> <span class="n">expr</span> <span class="ow">in</span> <span class="n">sequence1</span><br/>&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="n">condition1</span><br/>&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">for</span> <span class="n">expr2</span> <span class="ow">in</span> <span class="n">sequence2</span><br/>&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="n">condition2</span><br/>&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">for</span> <span class="n">expr3</span> <span class="ow">in</span> <span class="n">sequence3</span> <span class="o">...</span><br/>&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="n">condition3</span><br/>&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">for</span> <span class="n">exprN</span> <span class="ow">in</span> <span class="n">sequenceN</span><br/>&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="n">conditionN</span> <span class="p">)</span><br/></div></code></pre><p class="note text-center">visual messive!</p></section><section class="fullcode slide">
<pre><code><div class="codehilite"><span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span><br/><span class="kn">from</span> <span class="nn">zipfile</span> <span class="kn">import</span> <span class="n">ZipFile</span><br/><br/><span class="n">files_stream</span> <span class="o">=</span> <span class="p">(</span><br/>&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">ZipFile</span><span class="p">(</span><span class="nb">file</span><span class="o">.</span><span class="n">name</span><span class="p">)</span><br/>&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">for</span> <span class="nb">file</span> <span class="ow">in</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">iterdir</span><span class="p">()</span><br/>&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="nb">file</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;.zip&#39;</span><span class="p">)</span><br/><span class="p">)</span><br/><br/><span class="n">zipped_content_list</span> <span class="o">=</span> <span class="p">[]</span><br/><span class="k">for</span> <span class="n">a_zipfile</span> <span class="ow">in</span> <span class="n">files_stream</span><span class="p">:</span><br/>&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">for</span> <span class="n">item_name</span> <span class="ow">in</span> <span class="n">a_zipfile</span><span class="o">.</span><span class="n">namelist</span><span class="p">():</span><br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">zipped_content_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item_name</span><span class="p">)</span><br/></div></code></pre></section><section class="slide"><h2 class="shout">Rewrite in<br/>a reactive style</h2></section><section class="fullcode slide">
<pre><code><div class="codehilite"><span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span><br/><span class="kn">from</span> <span class="nn">zipfile</span> <span class="kn">import</span> <span class="n">ZipFile</span><br/><span class="kn">from</span> <span class="nn">functional</span> <span class="kn">import</span> <span class="n">seq</span><br/><br/><span class="n">zipped_content_list</span> <span class="o">=</span> <span class="p">(</span><br/>&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">seq</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">iterdir</span><span class="p">())</span><br/>&nbsp;&nbsp;&nbsp;&nbsp;<span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">item</span><span class="p">:</span> <span class="n">item</span><span class="o">.</span><span class="n">is_file</span><span class="p">())</span><br/>&nbsp;&nbsp;&nbsp;&nbsp;<span class="o">.</span><span class="n">filter</span><span class="p">(</span><br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">lambda</span> <span class="nb">file</span><span class="p">:</span> <span class="nb">file</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;.zip&#39;</span><span class="p">)</span><br/>&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">)</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">ZipFile</span><span class="p">)</span><br/>&nbsp;&nbsp;&nbsp;&nbsp;<span class="o">.</span><span class="n">flat_map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">a_zipfile</span><span class="p">:</span> <span class="n">a_zipfile</span><span class="o">.</span><span class="n">namelist</span><span class="p">())</span><br/><span class="p">)</span><br/></div></code></pre></section><section class="slide"><h2>Feel like SQL query</h2>
<pre><code><div class="codehilite"><span class="n">db</span><span class="o">.</span><span class="na">query</span><span class="o">(</span><span class="n">users</span><span class="o">)</span> <span class="err">\</span><br/>&nbsp;&nbsp;&nbsp;&nbsp;<span class="o">.</span><span class="na">filter</span><span class="o">(</span><span class="n">role</span> <span class="o">==</span> <span class="n">Cafe</span><span class="o">.</span><span class="na">customer</span><span class="o">)</span> <span class="err">\</span><br/>&nbsp;&nbsp;&nbsp;&nbsp;<span class="o">.</span><span class="na">filter</span><span class="o">(</span><span class="n">cups_bought</span> <span class="o">&gt;=</span> <span class="mi">100_000_000</span><span class="o">)</span> <span class="err">\</span><br/>&nbsp;&nbsp;&nbsp;&nbsp;<span class="o">.</span><span class="na">update</span><span class="o">(</span><span class="n">state</span><span class="o">=</span><span class="s">&quot;caffeinated&quot;</span><span class="o">)</span><br/></div></code></pre></section><section class="slide"><h2 class="shout">Better?<br/>It depends.</h2></section><section class="slide"><h2>Why Reactive Programming</h2><ul><li>Abstraction</li><li>Focus on business logic</li><li>Concise code</li><li>Performance<ul class="next"><li>Usually seen in <mark><strong>asynchronous</strong></mark> context</li><li>Parallel processing, smallest unit of change</li></ul></li></ul></section><section class="slide"><h2 class="shout">Aannndddd...</h2></section><section class="slide"><h2 class="shout"><i class="fa fa-check-square-o"></i> Functional</h2></section><section class="slide"><h2 class="focustitle red">Quicksort Example</h2><img src="pictures/qsort.png" alt="" class="cover"/></section><section class="slide"><h2>Quicksort logic in Ocaml</h2>
<pre><code><div class="codehilite"><span class="k">let</span> <span class="k">rec</span> <span class="n">qsort</span> <span class="o">=</span> <span class="k">function</span><br/>&nbsp;&nbsp;&nbsp;&nbsp;<span class="o">|</span> <span class="bp">[]</span> <span class="o">-&gt;</span> <span class="bp">[]</span><br/>&nbsp;&nbsp;&nbsp;&nbsp;<span class="o">|</span> <span class="n">pivot</span> <span class="o">::</span> <span class="n">rest</span> <span class="o">-&gt;</span><br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">let</span> <span class="n">is_less</span> <span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="n">pivot</span> <span class="k">in</span><br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">let</span> <span class="n">left</span><span class="o">,</span> <span class="n">right</span> <span class="o">=</span> <span class="nn">List</span><span class="p">.</span><span class="n">partition</span> <span class="n">is_less</span> <span class="n">rest</span> <span class="k">in</span><br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">qsort</span> <span class="n">left</span> <span class="o">@</span> <span class="o">[</span><span class="n">pivot</span><span class="o">]</span> <span class="o">@</span> <span class="n">qsort</span> <span class="n">right</span><span class="o">;;</span><br/></div></code></pre></section><section class="slide"><h2>Code Smell</h2>
<pre><code><div class="codehilite"><span class="n">num_stream</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span><br/><br/><span class="n">evens1</span> <span class="o">=</span> <span class="p">[]</span><br/><span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">numbers</span><span class="p">:</span><br/>&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="p">(</span><span class="n">n</span> <span class="o">%</span> <span class="mi">2</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span><br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">evens1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>&nbsp; <span class="c1"># Imperactive</span><br/><br/><span class="n">evens2</span> <span class="o">=</span> <span class="p">[</span><span class="n">n</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">num_stream</span> <span class="k">if</span> <span class="p">(</span><span class="n">n</span> <span class="o">%</span> <span class="mi">2</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span><br/><br/><span class="c1"># List comprehension result: [2, 4, 6]</span><br/></div></code></pre></section><section class="slide"><h2 class="shout">Try<br/>PyFunctional</h2></section><section class="slide"><h2>Code Smell (Cont.)</h2><h3>Functional Reactive Programming (FRP)</h3>
<pre><code><div class="codehilite"><span class="kn">from</span> <span class="nn">functional</span> <span class="kn">import</span> <span class="n">seq</span><br/><br/><span class="k">def</span> <span class="nf">is_even</span><span class="p">(</span><span class="n">num</span><span class="p">):</span>&nbsp; <span class="c1"># Big business logic!</span><br/>&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">return</span> <span class="p">(</span><span class="n">num</span> <span class="o">%</span> <span class="mi">2</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><br/><br/><span class="n">evens3</span> <span class="o">=</span> <span class="n">seq</span><span class="p">(</span><span class="n">num_stream</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">is_even</span><span class="p">)</span><br/><span class="c1"># [2, 4, 6]</span><br/></div></code></pre><p class="note text-center"><code>functional</code> module is provided by PyFunctional
</p></section><section class="slide"><h2>Real life example: find_kernels()</h2>
<pre><code><div class="codehilite"><span class="n">kernels</span> <span class="o">=</span> <span class="p">[</span><br/>&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">f</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">folder_path</span><span class="o">.</span><span class="n">iterdir</span><span class="p">()</span><br/>&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">is_file</span><span class="p">()</span> <span class="ow">and</span> <span class="n">f</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;vmlinuz&#39;</span><span class="p">)</span><br/><span class="p">]</span><br/><span class="c1"># How to add one or two more levels of loop?</span><br/><br/><span class="n">kernels</span> <span class="o">=</span> <span class="n">seq</span><span class="p">(</span><span class="n">folder_path</span><span class="o">.</span><span class="n">iterdir</span><span class="p">())</span> \<br/>&nbsp;&nbsp;&nbsp;&nbsp;<span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">f</span><span class="p">:</span> <span class="n">f</span><span class="o">.</span><span class="n">is_file</span><span class="p">())</span> \<br/>&nbsp;&nbsp;&nbsp;&nbsp;<span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">f</span><span class="p">:</span> <span class="n">f</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;vmlinuz&#39;</span><span class="p">))</span> \<br/>&nbsp;&nbsp;&nbsp;&nbsp;<span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">f</span><span class="p">:</span> <span class="s1">&#39;rescue&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">k</span><span class="o">.</span><span class="n">name</span><span class="p">)</span> \<br/>&nbsp;&nbsp;&nbsp;&nbsp;<span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">f</span><span class="p">:</span> <span class="n">f</span><span class="o">.</span><span class="n">name</span><span class="p">)</span><br/></div></code></pre></section><section class="slide"><h2 class="shout">A = B + C</h2></section><section class="slide loading"><h2 class="focustitle red">Spreadsheet</h2><img src="pictures/spreadsheet.png" alt="" class="cover"/></section><section class="slide loading"><h2 class="focustitle red">Spreadsheet is “Reactive”</h2><img src="pictures/spreadsheet_react.png" alt="" class="cover"/></section><section class="slide"><h2>Recap: What Reactive Programming</h2><ul>
<li>A programming paradigm</li>
<li>Core spirit: Stream</li>
<li>Code look
<ul>
<li>sequences</li>
<li>map</li>
<li>lambda</li>
</ul></li>
</ul></section><section class="slide"><h2>Recap: Why Reactive Programming</h2><ul>
<li>Functional stylesheet
<br/><i class="fa fa-long-arrow-right"></i> focus on logic</li>
<li>Asynchronous candy
<br/><i class="fa fa-long-arrow-right"></i> performance in a concise way</li>
</ul></section><section class="slide"><h2 class="shout">II. Dive into Reactive <i class="kblack fa fa-stethoscope"></i></h2></section><section class="outlines slide"><h2>Stream Fun</h2><ol><li>Alike workload</li><li>Merge</li><li>Re-use</li></ol></section><section class="slide"><h2>A example powered by RxPy (rx)</h2>
<pre><code><div class="codehilite"><span class="kn">import</span> <span class="nn">rx</span><br/><span class="n">num_stream</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span><br/><br/><span class="n">num_flow</span> <span class="o">=</span> <span class="n">rx</span><span class="o">.</span><span class="n">Observable</span><span class="o">.</span><span class="n">from_</span><span class="p">(</span><span class="n">num_stream</span><span class="p">)</span><br/><span class="n">num_flow</span><span class="o">.</span><span class="n">subscribe</span><span class="p">(</span><span class="k">print</span><span class="p">)</span><br/></div></code></pre></section><section class="fullcode slide">
<pre><code><div class="codehilite"><span class="n">In</span> <span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="kn">import</span> <span class="nn">rx</span><br/><br/><span class="n">In</span> <span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="n">num_stream</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span><br/><br/><span class="n">In</span> <span class="p">[</span><span class="mi">3</span><span class="p">]:</span> <span class="n">num_flow</span> <span class="o">=</span> <span class="n">rx</span><span class="o">.</span><span class="n">Observable</span><span class="o">.</span><span class="n">from_</span><span class="p">(</span><span class="n">num_stream</span><span class="p">)</span><br/><br/><span class="n">In</span> <span class="p">[</span><span class="mi">4</span><span class="p">]:</span> <span class="n">num_flow</span><span class="o">.</span><span class="n">subscribe</span><span class="p">(</span><span class="k">print</span><span class="p">)</span><br/><span class="mi">1</span><br/><span class="mi">2</span><br/><span class="mi">3</span><br/><span class="mi">4</span><br/><span class="n">Out</span><span class="p">[</span><span class="mi">4</span><span class="p">]:</span> <span class="o">&lt;</span><span class="n">rx</span><span class="o">.</span><span class="n">disposables</span><span class="o">.</span><span class="n">AnonymousDisposable</span><br/>&nbsp;&nbsp;&nbsp;&nbsp;<span class="o">.</span><span class="n">AnonymousDisposable</span> <span class="n">at</span> <span class="mh">0x1041fcac8</span><span class="o">&gt;</span><br/></div></code></pre></section><section class="slide"><h2>Merge</h2>
<pre><code><div class="codehilite"><span class="n">chars_flow</span> <span class="o">=</span> <span class="n">rx</span><span class="o">.</span><span class="n">Observable</span><span class="o">.</span><span class="n">from_</span><span class="p">([</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">])</span><br/><span class="n">numbers_flow</span> <span class="o">=</span> <span class="n">rx</span><span class="o">.</span><span class="n">Observable</span><span class="o">.</span><span class="n">from_</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span><br/><span class="c1"># or rx.Observable.range(1, 4)</span><br/><br/><span class="n">printable_flow</span> <span class="o">=</span> <span class="n">numbers_flow</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><br/>&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">lambda</span> <span class="n">num</span><span class="p">:</span> <span class="n">num</span> <span class="o">*</span> <span class="mi">2</span><br/><span class="p">)</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">chars_flow</span><span class="p">)</span><br/><br/><span class="n">printable_flow</span><span class="o">.</span><span class="n">subscribe</span><span class="p">(</span><span class="k">print</span><span class="p">)</span><br/><span class="c1"># a 2 b 4 c 6 8 10</span><br/></div></code></pre></section><section class="fullcode slide"><h2>Most.js - Live Demo</h2><figure><blockquote>Mouse position X, Y = <span class="most-show"></span></blockquote></figure><br/>
<pre><code><div class="codehilite"><span class="nx">most</span><span class="p">.</span><span class="nx">fromEvent</span><span class="p">(</span><span class="s1">&#39;mousemove&#39;</span><span class="p">,</span> <span class="nb">document</span><span class="p">)</span><br/>&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="p">{</span><br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">return</span> <span class="nx">event</span><span class="p">.</span><span class="nx">clientX</span> <span class="o">+</span> <span class="s1">&#39;,&#39;</span> <span class="o">+</span> <span class="nx">event</span><span class="p">.</span><span class="nx">clientY</span><span class="p">;</span><br/>&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">})</span><br/>&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">.</span><span class="nx">startWith</span><span class="p">(</span><span class="s1">&#39;move the mouse, please&#39;</span><span class="p">)</span><br/>&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">.</span><span class="nx">observe</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">xy_str</span><span class="p">)</span> <span class="p">{</span><br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">textContent</span> <span class="o">=</span> <span class="nx">xy_str</span><span class="p">;</span><br/>&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">});</span><br/></div></code></pre><p class="note text-center">Most.js - Monadic reactive streams</p></section><section class="slide"><h2><a href="http://reactivex.io/">ReactiveX</a></h2><ul>
<li>Microsoft's open-source <a href="http://msdn.microsoft.com/en-us/data/gg577609.aspx">Reactive Extensions</a> library (Rx)</li>
<li>Compose programs of
<ul>
<li>Asynchronous</li>
<li>Event-based</li>
</ul></li>
<li>By using observable sequences.</li>
</ul></section><section class="slide"><h2>ReactiveX (Cont.)</h2><img src="pictures/rx.jpg" alt="" width="100%" class="cover"/><ul class="kwhite"><li>RxPy</li><li>RxJava</li><li>RxJS</li><li>Rx.NET</li><li>RxSwift</li></ul></section><section class="slide"><h2>Even in C++: RxCpp</h2>
<pre><code><div class="codehilite"><span class="k">auto</span> <span class="n">num_flow</span> <span class="o">=</span> <span class="n">rxcpp</span><span class="o">::</span><span class="n">observable</span><span class="o">&lt;&gt;::</span><span class="n">create</span><span class="p">(</span><br/>&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">[](</span><span class="n">rxcpp</span><span class="o">::</span><span class="n">subscriber</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">s</span><span class="p">){</span><br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">for</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;=</span><span class="mi">5</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span><br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">s</span><span class="p">.</span><span class="n">on_next</span><span class="p">(</span><span class="n">i</span><span class="p">);</span><br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">s</span><span class="p">.</span><span class="n">on_completed</span><span class="p">();</span><br/>&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">});</span><br/><br/><span class="n">num_flow</span><span class="p">.</span><span class="n">subscribe</span><span class="p">(</span><br/>&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">[](</span><span class="kt">int</span> <span class="n">v</span><span class="p">){</span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;OnNext: %d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">v</span><span class="p">);},</span><br/>&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">[](){</span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;OnCompleted</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);});</span><br/></div></code></pre></section><section class="slide"><h2>Abstract away</h2><ul>
<li>Low-level threading</li>
<li>Synchronization</li>
<li>Thread-safety</li>
<li>Concurrent data structures</li>
<li>Non-blocking I/O</li>
</ul></section><section class="slide"><h2 class="shout">Focus <i class="fa fa-star"></i><br/>on biz logic</h2></section><section class="slide"><h2>Concurrent</h2><img src="pictures/gopher_concurrency.jpg"/></section><section class="slide"><h2>Parallel</h2><img src="pictures/gopher_parallel.jpg" width="50%"/><figure></figure><blockquote>Parallel execution is concurrent by definition,
but concurrency is not necessarily parallelism.</blockquote></section><section class="slide"><h2 class="shout"><span class="kblack">Asynchronous</span> Programming is Ha...Ha...Hard</h2></section><section class="fullcode max slide">
<pre><code><div class="codehilite"><span class="kn">import</span> <span class="nn">time</span><br/><span class="kn">import</span> <span class="nn">concurrent.futures</span><br/><span class="kn">import</span> <span class="nn">rx</span><br/><br/><span class="n">num_stream</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span><br/><br/><span class="k">def</span> <span class="nf">work_slowly</span><span class="p">(</span><span class="n">data</span><span class="p">):</span><br/>&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><br/>&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">return</span> <span class="n">data</span> <span class="o">*</span> <span class="mi">2</span><br/><br/><span class="k">with</span> <span class="n">concurrent</span><span class="o">.</span><span class="n">futures</span><span class="o">.</span><span class="n">ProcessPoolExecutor</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="k">as</span> <span class="n">worker</span><span class="p">:</span><br/>&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">rx</span><span class="o">.</span><span class="n">Observable</span><span class="o">.</span><span class="n">from_</span><span class="p">(</span><span class="n">num_stream</span><span class="p">)</span> \<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="o">.</span><span class="n">flat_map</span><span class="p">(</span><br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">lambda</span> <span class="n">num</span><span class="p">:</span> <span class="n">worker</span><span class="o">.</span><span class="n">submit</span><span class="p">(</span><span class="n">work_slowly</span><span class="p">,</span> <span class="n">num</span><span class="p">)</span><br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">)</span><span class="o">.</span><span class="n">subscribe</span><span class="p">(</span><span class="k">print</span><span class="p">)</span><br/></div></code></pre></section><section class="slide"><h2>Observable, flat_map, subscribe</h2>
<pre><code><div class="codehilite"><span class="k">with</span> <span class="n">concurrent</span><span class="o">.</span><span class="n">futures</span><span class="o">.</span><span class="n">ProcessPoolExecutor</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="k">as</span> <span class="n">worker</span><span class="p">:</span><br/>&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">rx</span><span class="o">.</span><span class="n">Observable</span><span class="o">.</span><span class="n">from_</span><span class="p">(</span><span class="n">num_stream</span><span class="p">)</span> \<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="o">.</span><span class="n">flat_map</span><span class="p">(</span><br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">lambda</span> <span class="n">num</span><span class="p">:</span> <span class="n">worker</span><span class="o">.</span><span class="n">submit</span><span class="p">(</span><span class="n">work_slowly</span><span class="p">,</span> <span class="n">num</span><span class="p">)</span><br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">)</span><span class="o">.</span><span class="n">subscribe</span><span class="p">(</span><span class="k">print</span><span class="p">)</span><br/></div></code></pre></section><section class="slide"><h2 class="shout">Why & What<br/>Observables</h2></section><section class="slide"><h2>Why Observables</h2><figure></figure><blockquote>Observable model allows you to <mark>treat</mark> streams
of Asynchronous events with the <mark>same sort of operations</mark>
that you use for collections of data items like arrays.
It <mark>frees you from callbacks</mark>, and thereby makes your code more
readable and <mark>less prone to bugs</mark>.</blockquote></section><section class="slide"><h2>What Observables</h2><figure></figure><blockquote>To support receiving events via push,
an Observable/Observer pair connect via subscription.
The Observable <mark>represents the stream of data</mark>
and <mark>can be subscribed to by an Observer</mark></blockquote></section><section class="slide"><h2>What Observables (Cont.)</h2><figure></figure><blockquote>An Rx Observable is the <mark>async “dual” of an Iterable</mark>.
By “dual”, it means that the Observable provides
all the functionality of an Iterable except in
the reverse flow of data: it is push instead of pull.</blockquote></section><section class="slide"><h2>Observable v.s. Iterable</h2><table><tr><th>Pull (Iterable)</th><th>Push (Observable)</th></tr><tr><td>it.next()</td><td>on_next(it)</td></tr><tr><td>raise Exception</td><td>on_error(Exception)</td></tr><tr><td>returns</td><td>on_completed()</td></tr></table></section><section class="slide"><h2>flat_map</h2><figure></figure><blockquote>I want values,<br/><i class="fa fa-long-arrow-right"></i> inside each event.<figure></figure></blockquote><blockquote>To compose asynchronous streams<br/><i class="fa fa-long-arrow-right"></i> together concurrently.</blockquote></section><section class="slide"><h2>Imaginate the behavior of flat_map()</h2>
<pre><code><div class="codehilite"><span class="n">str_lists</span> <span class="o">=</span> <span class="p">[[</span><span class="s2">&quot;6&quot;</span><span class="p">,</span> <span class="s2">&quot;03&quot;</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;42&quot;</span><span class="p">]]</span><br/><br/><span class="n">list1</span> <span class="o">=</span> <span class="p">[]</span><br/><span class="k">for</span> <span class="n">str_list</span> <span class="ow">in</span> <span class="n">str_lists</span><span class="p">:</span><br/>&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">str_list</span><span class="p">:</span><br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">list1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">var</span><span class="p">))</span><br/><br/><span class="c1"># [6, 3, 42]</span><br/></div></code></pre><p class="note text-center">This example is much simplified for imagination purpose.</p></section><section class="slide"><h2>flat_map in PyFunctional</h2>
<pre><code><div class="codehilite"><span class="kn">from</span> <span class="nn">functional</span> <span class="kn">import</span> <span class="n">seq</span><br/><br/><span class="k">def</span> <span class="nf">int_list</span><span class="p">(</span><span class="n">iterable</span><span class="p">):</span><br/>&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">return</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">var</span><span class="p">)</span> <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">iterable</span><span class="p">]</span><br/><br/><span class="n">list2</span> <span class="o">=</span> <span class="n">seq</span><span class="p">(</span><span class="n">str_lists</span><span class="p">)</span><span class="o">.</span><span class="n">flat_map</span><span class="p">(</span><span class="n">int_list</span><span class="p">)</span><br/><span class="c1"># [6, 3, 42]</span><br/></div></code></pre></section><section class="slide"><h2>Parallel with Rx Schedulers</h2><figure><blockquote>Rx is concurrency-agnostic and as a matter of fact
it does not introduce concurrency on its own.</blockquote></figure><figure><blockquote>You can use every scheduler you like
to decide where to execute the work.</blockquote></figure></section><section class="slide"><h2>A RxJava example</h2>
<pre><code><div class="codehilite"><span class="n">Observable</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">num_flow</span> <span class="o">=</span> <span class="n">Observable</span><br/>&nbsp;&nbsp;&nbsp;&nbsp;<span class="o">.</span><span class="na">range</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">6</span><span class="o">)</span><br/>&nbsp;&nbsp;&nbsp;&nbsp;<span class="o">.</span><span class="na">doOnEach</span><span class="o">(</span><span class="n">debug</span><span class="o">(</span><span class="s">&quot;Did&quot;</span><span class="o">));</span><br/><br/><span class="n">num_flow</span><span class="o">.</span><span class="na">subscribe</span><span class="o">(</span><span class="n">num</span> <span class="o">-&gt;</span> <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">num</span><span class="o">));</span><br/></div></code></pre></section><section class="slide"><h2>Parallel with RxJava</h2>
<pre><code><div class="codehilite"><span class="n">Observable</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">num_flow</span> <span class="o">=</span> <span class="n">Observable</span><br/>&nbsp;&nbsp;&nbsp;&nbsp;<span class="o">.</span><span class="na">range</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">6</span><span class="o">)</span><br/>&nbsp;&nbsp;&nbsp;&nbsp;<span class="o">.</span><span class="na">flatMap</span><span class="o">(</span><span class="n">n</span> <span class="o">-&gt;</span> <span class="n">Observable</span><br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="o">.</span><span class="na">range</span><span class="o">(</span><span class="n">n</span><span class="o">,</span> <span class="mi">3</span><span class="o">)</span><br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="o">.</span><span class="na">subscribeOn</span><span class="o">(</span><span class="n">Schedulers</span><span class="o">.</span><span class="na">computation</span><span class="o">())</span><br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="o">.</span><span class="na">doOnEach</span><span class="o">(</span><span class="n">debug</span><span class="o">(</span><span class="s">&quot;Did&quot;</span><span class="o">))</span><br/>&nbsp;&nbsp;&nbsp;&nbsp;<span class="o">);</span><br/><span class="n">num_flow</span><span class="o">.</span><span class="na">subscribe</span><span class="o">(</span><span class="n">num</span> <span class="o">-&gt;</span> <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">num</span><span class="o">));</span><br/></div></code></pre></section><section class="slide"><h2>The look of parallel output</h2>
<pre><code><div class="codehilite"><span class="n">RxComputationThreadPool</span><span class="o">-</span><span class="mi">3</span><span class="o">|</span><span class="n">Did</span><span class="p">:</span> <span class="o">&gt;</span><span class="mi">3</span><br/><span class="n">RxComputationThreadPool</span><span class="o">-</span><span class="mi">1</span><span class="o">|</span><span class="n">Did</span><span class="p">:</span> <span class="o">&gt;</span><span class="mi">1</span><br/><span class="n">RxComputationThreadPool</span><span class="o">-</span><span class="mi">2</span><span class="o">|</span><span class="n">Did</span><span class="p">:</span> <span class="o">&gt;</span><span class="mi">4</span><br/><span class="n">RxComputationThreadPool</span><span class="o">-</span><span class="mi">3</span><span class="o">|</span><span class="n">Did</span><span class="p">:</span> <span class="o">-&gt;</span><span class="mi">2</span><br/><span class="n">RxComputationThreadPool</span><span class="o">-</span><span class="mi">1</span><span class="o">|</span><span class="n">Did</span><span class="p">:</span> <span class="o">&gt;</span><span class="mi">7</span><br/><span class="n">RxComputationThreadPool</span><span class="o">-</span><span class="mi">2</span><span class="o">|</span><span class="n">Did</span><span class="p">:</span> <span class="o">-&gt;</span><span class="mi">6</span><br/><span class="n">RxComputationThreadPool</span><span class="o">-</span><span class="mi">3</span><span class="o">|</span><span class="n">Did</span><span class="p">:</span> <span class="o">--&gt;</span><span class="mi">5</span><br/><span class="n">RxComputationThreadPool</span><span class="o">-</span><span class="mi">3</span><span class="o">|</span><span class="n">Did</span><span class="p">:</span> <span class="o">---&gt;|</span><br/></div></code></pre></section><section class="slide"><h2 class="shout">RxPy<br/>with Scheduler</h2></section><section class="fullcode max slide">
<pre><code><div class="codehilite"><span class="kn">import</span> <span class="nn">time</span><br/><span class="kn">import</span> <span class="nn">rx</span><br/><br/><span class="k">def</span> <span class="nf">work_slowly</span><span class="p">(</span><span class="n">value</span><span class="p">):</span><br/>&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">def</span> <span class="nf">go_make_big</span><span class="p">(</span><span class="n">subscriber</span><span class="p">):</span><br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">subscriber</span><span class="o">.</span><span class="n">on_next</span><span class="p">(</span><span class="n">make_big</span><span class="p">(</span><span class="n">value</span><span class="p">))</span><br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">subscriber</span><span class="o">.</span><span class="n">on_completed</span><span class="p">()</span><br/>&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">return</span> <span class="n">rx</span><span class="o">.</span><span class="n">Observable</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">go_make_big</span><span class="p">)</span><br/><br/><span class="k">def</span> <span class="nf">make_big</span><span class="p">(</span><span class="n">value</span><span class="p">):</span><br/>&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">print</span><span class="p">(</span><span class="s2">&quot;Make big {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">value</span><span class="p">))</span><br/>&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><br/>&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">print</span><span class="p">(</span><span class="s2">&quot;Done for big {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">value</span><span class="p">))</span><br/>&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">return</span> <span class="n">value</span> <span class="o">*</span> <span class="mi">2</span><br/><br/><span class="n">scheduler</span> <span class="o">=</span> <span class="n">rx</span><span class="o">.</span><span class="n">concurrency</span><span class="o">.</span><span class="n">NewThreadScheduler</span><span class="p">()</span><br/><span class="n">total_value</span> <span class="o">=</span> <span class="n">rx</span><span class="o">.</span><span class="n">Observable</span><span class="o">.</span><span class="n">from_</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span> \<br/>&nbsp;&nbsp;&nbsp;&nbsp;<span class="o">.</span><span class="n">flat_map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">num</span><span class="p">:</span> <span class="n">work_slowly</span><span class="p">(</span><span class="n">num</span><span class="p">)</span> \<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="o">.</span><span class="n">subscribe_on</span><span class="p">(</span><span class="n">scheduler</span><span class="p">))</span> \<br/>&nbsp;&nbsp;&nbsp;&nbsp;<span class="o">.</span><span class="n">reduce</span><span class="p">(</span><span class="k">lambda</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="p">)</span> \<br/>&nbsp;&nbsp;&nbsp;&nbsp;<span class="o">.</span><span class="n">subscribe</span><span class="p">(</span><span class="k">print</span><span class="p">)</span><br/><br/><span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">1.1</span><span class="p">)</span><br/></div></code></pre></section><section class="slide"><h2>Output by using NewThreadScheduler</h2>
<pre><code><div class="codehilite">Make big 1<br/>Make big 2<br/>Make big 3<br/>Make big 4<br/>Done for big 2<br/>Done for big 1<br/>Done for big 3<br/>Done for big 4<br/>20<br/></div></code></pre></section><section class="slide"><h2>RxPy Schedulers</h2><figure><blockquote>In RxPY you can choose to run fully asynchronously or you may decide
to schedule work and timeouts using threads.</blockquote></figure><figure><blockquote>RxPY also comes with batteries included, and has a number of Python
specific mainloop schedulers to make it easier for you to use RxPY
with your favorite Python framework.</blockquote></figure></section><section class="slide"><h2>RxPy Schedulers (Cont.)</h2><ul class="fs-s"><li>AsyncIOScheduler <i class="fa fa-long-arrow-left"></i> <mark>AsyncIO</mark></li><li>IOLoopScheduler <i class="fa fa-long-arrow-left"></i> <mark>IOLoop</mark></li><li>GEventScheduler <i class="fa fa-long-arrow-left"></i> <mark>GEvent</mark></li><li>TwistedScheduler <i class="fa fa-long-arrow-left"></i> <mark>Twisted</mark></li><li>TkinterScheduler <i class="fa fa-long-arrow-left"></i> <mark>Tkinter</mark></li><li>PyGameScheduler <i class="fa fa-long-arrow-left"></i> <mark>PyGame</mark></li><li>QtScheduler <i class="fa fa-long-arrow-left"></i> <mark>Qt</mark></li><li>WxScheduler <i class="fa fa-long-arrow-left"></i> <mark>Wx</mark></li></ul></section><section class="slide"><h2 class="shout">Some<br/>more things</h2></section><section class="slide"><h2>Parallel Algorithms in PyToolz</h2><p>PyToolz does <mark>not implement</mark> parallel processing systems.
It does however <mark>provide parallel algorithms</mark> that can extend
existing parallel systems. Our general solution is to build
algorithms that operate around a <mark>user-supplied parallel map</mark> function.</p></section><section class="fullcode max slide">
<pre><code><div class="codehilite"><span class="kn">from</span> <span class="nn">toolz.curried</span> <span class="kn">import</span> <span class="nb">map</span><br/><span class="kn">from</span> <span class="nn">toolz</span> <span class="kn">import</span> <span class="n">frequencies</span><span class="p">,</span> <span class="n">compose</span><span class="p">,</span> <span class="n">concat</span><span class="p">,</span> <span class="n">merge_with</span><br/><br/><span class="k">def</span> <span class="nf">stem</span><span class="p">(</span><span class="n">word</span><span class="p">):</span><br/>&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">word</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s2">&quot;,.!)-*_?:;$&#39;-&quot;&quot;).lstrip(&quot;</span><span class="o">-*</span><span class="s1">&#39;&quot;(_$&#39;</span><span class="s2">&quot;)</span><br/><br/><span class="n">wordcount</span> <span class="o">=</span> <span class="n">compose</span><span class="p">(</span><span class="n">frequencies</span><span class="p">,</span> <span class="nb">map</span><span class="p">(</span><span class="n">stem</span><span class="p">),</span> <span class="n">concat</span><span class="p">,</span> <span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="o">.</span><span class="n">split</span><span class="p">),</span> <span class="nb">open</span><span class="p">)</span><br/><span class="n">filenames</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Book_</span><span class="si">%d</span><span class="s1">.txt&#39;</span><span class="o">%</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10000</span><span class="p">)]</span><br/><br/><span class="c1"># Advance to Multiprocessing map for heavy computation on single machine</span><br/><span class="c1"># from multiprocessing import Pool</span><br/><span class="c1"># p = Pool(8)</span><br/><span class="c1"># pmap = p.map</span><br/><br/><span class="c1"># Finish with distributed parallel map for big data</span><br/><span class="kn">from</span> <span class="nn">IPython.parallel</span> <span class="kn">import</span> <span class="n">Client</span><br/><span class="n">p</span> <span class="o">=</span> <span class="n">Client</span><span class="p">()[:]</span><br/><span class="n">pmap</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">map_sync</span><br/><br/><span class="n">total</span> <span class="o">=</span> <span class="n">merge_with</span><span class="p">(</span><span class="nb">sum</span><span class="p">,</span> <span class="n">pmap</span><span class="p">(</span><span class="n">wordcount</span><span class="p">,</span> <span class="n">filenames</span><span class="p">))</span><br/></div></code></pre></section><section class="slide"><h2 class="shout">III. Summary <i class="fa fa-thumbs-up"></i></h2></section><section class="slide"><h2 class="shout">Try functional<br/>& async with Rx</h2></section><section class="slide"><h2>Try functional & async with Rx</h2><ul>
<li>Master the <mark>stream</mark> of repeated and alike <mark>events</mark></li>
<li>Focus on the <mark>business logic</mark>
<ul>
<li>powered by functional programming.</li>
</ul></li>
<li>Drive <mark>asynchronous</mark> programming</li>
</ul></section><section id="references" class="slide"><h2>References</h2><ul><li>Book: <a href="https://www.packtpub.com/application-development/python-reactive-programming">Python Reactive Programming</a>, November 2016</li><li>Book: <a href="https://www.safaribooksonline.com/library/view/reactive-programming-with/9781783984343/">Reactive Programming with Scala and Akka</a>, February 2016</li><li>Book: <a href="https://www.safaribooksonline.com/library/view/reactive-programming-with/9781491931646/">Reactive Programming with RxJava</a>, August 2016</li><p><a href="https://www.packtpub.com/application-development/python-reactive-programming"><img src="pictures/rxpybook.png" alt="by Dag Brattli"/></a> <a href="https://www.safaribooksonline.com/library/view/reactive-programming-with/9781783984343/"><img src="pictures/rxscalabook.png" alt="by Suraj Atreya; Prasanna Kumar Sathyanarayanan"/></a> <a href="https://www.safaribooksonline.com/library/view/reactive-programming-with/9781491931646/"><img src="pictures/rxjavabook.gif" alt="by Ben Christensen; Tomasz Nurkiewicz"/></a></p></ul><p class="note text-center"><i>Python Reactive Programming</i> is wrote by Dag Brattli, RxPy author</p><style>#references img {
  height: 200px; }
  #references ul li {
    font-size: smaller; }</style></section><section class="slide"><h2>References (Cont.)</h2><ul><li>On Github <i class="fa fa-github"></i> : PyFunctional, RxPy</li><li>Gist:<i>The introduction to Reactive Programming you've been missing </i>by @andrestaltz, <span class="not">including the use case of <mark>Promise</mark></span></li><li>Slide:<i>Functional Reactive Python On Introducing CS to High School Students </i>by John Peterson</li></ul></section><section class="slide"><h2 class="shout text-center">Q&A <i class="fa fa-battery-1"></i></h2></section><section class="slide"><h2 class="shout">Thank You! <i class="fa fa-battery-empty"></i></h2></section><div class="progress"></div><!-- Copyright © 2016 Keith Yang -->
<script src="shower/shower.min.js">
</script><script src="lib/most.min.js">
</script><script>
most.fromEvent('mousemove', document)
    .map(function(event) {
        return event.clientX + ', ' + event.clientY;
    })
    .startWith('move the mouse, please')
    .observe(function(xy_str) {
        document.querySelector('.most-show').textContent =  xy_str;
    });</script><script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-4248558-11', 'auto');
ga('send', 'pageview');</script></body></html>